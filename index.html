<!-- Сообщаем браузеру как стоит обрабатывать эту страницу -->
<!DOCTYPE html>
<!-- Оболочка документа, указываем язык содержимого -->
<html lang="ru">
	<!-- Заголовок страницы, контейнер для других важных данных (не отображается) -->
	<head>
		<!-- Заголовок страницы в браузере -->
		<title>Раздача ролей</title>
		<link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
		<!-- Подключаем CSS -->
		<link rel="stylesheet" href="css/style.css" />
		<link href='https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css' rel='stylesheet'>
		<!-- Кодировка страницы -->
		<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
		<meta name="viewport" content="width=device-width">
	</head>
	<body>
		<div class="wrapper">
			<div class="flex">
				<div class="block_btn">
					<button class="block_btn-text btn_nine"><span>9 игроков</span></button>
					<button class="block_btn-text btn_ten active"><span>10 игроков</span></button>
				</div>
				<div class="block_btn">
					<button class="block_btn-text btn_number active"><span>Номера</span></button>
					<button class="block_btn-text btn_role"><span>Роли</span></button>
				</div>
			</div>
			<div class="flex">
				<div class="card">
					<div class="block_card">
						<div class="block_card_front"></div>
						<div class="block_card_back"></div>	
					</div>
				</div>
				<div class="card">
					<div class="block_card">
						<div class="block_card_front"></div>
						<div class="block_card_back"></div>
					</div>
				</div>
				<div class="card">
					<div class="block_card">
						<div class="block_card_front"></div>
						<div class="block_card_back"></div>
					</div>
				</div>
				<div class="card">
					<div class="block_card">
						<div class="block_card_front"></div>
						<div class="block_card_back"></div>
					</div>
				</div>
				<div class="card">
					<div class="block_card">
						<div class="block_card_front"></div>
						<div class="block_card_back"></div>
					</div>
				</div>
				<div class="card">
					<div class="block_card">
						<div class="block_card_front"></div>
						<div class="block_card_back"></div>
					</div>
				</div>
				<div class="card">
					<div class="block_card">
						<div class="block_card_front"></div>
						<div class="block_card_back"></div>
					</div>
				</div>
				<div class="card">
					<div class="block_card">
						<div class="block_card_front"></div>
						<div class="block_card_back"></div>
					</div>
				</div>
				<div class="card">
					<div class="block_card">
						<div class="block_card_front"></div>
						<div class="block_card_back"></div>
					</div>
				</div>
				<div class="card">
					<div class="block_card">
						<div class="block_card_front"></div>
						<div class="block_card_back"></div>
					</div>
				</div>
			</div>
		</div>
			
		<script>
			let role = ['мирный', 'мирный', 'мирный', 'мирный', 'мирный', 'мафия', 'мафия', 'босс', 'шериф', 'мирный'];
			let numberPlayers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
			let numberCard = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
			const cards = document.querySelectorAll('.block_card');
			const nums = document.querySelectorAll('.block_card_front');
			let btnOne = document.querySelector('.btn_number');
			let btnTwo = document.querySelector('.btn_role');
			let count = 9;


			function changeBtnAmoutPlayers() {
				let btnPlayersNine = document.querySelector('.btn_nine');
				let btnPlayersTen = document.querySelector('.btn_ten');

				btnPlayersNine.addEventListener('click', () => {
					role = ['мирный', 'мирный', 'мирный', 'мирный', 'мирный', 'мафия', 'мафия', 'босс', 'шериф', 'мирный']
					numberPlayers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
					numberCard = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
					if (btnPlayersNine.classList.contains("active")) {
					    btnPlayersNine.classList.remove("active");
					    btnPlayersTen.classList.add("active");
					    document.querySelectorAll('.block_card_front')
					    	.forEach(el => {
					    		if (el.innerHTML == 10){
					    			el.parentNode.parentNode.classList.remove('hidden_nine_players')
					    		}
							});
					}
					useRole()
					useNumPlayers()
					btnOne.classList.add("active");
					btnTwo.classList.remove("active");
				})
				btnPlayersTen.addEventListener('click', () => {
					role = ['мирный', 'мирный', 'мирный', 'мирный', 'мирный', 'мафия', 'мафия', 'босс', 'шериф', 'мирный']
					numberPlayers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
					numberCard = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
					role.pop()
					numberPlayers.pop()
					numberCard.pop()
					if (btnPlayersTen.classList.contains("active")) {
					    btnPlayersTen.classList.remove("active");
					    btnPlayersNine.classList.add("active");
					    document.querySelectorAll('.block_card_front')
							.forEach(el => {
					    		if (el.innerHTML == 10){
					    			el.parentNode.parentNode.classList.add('hidden_nine_players')
					    		}
							})
					}
					useRole()
					useNumPlayers()
				})
			}
			changeBtnAmoutPlayers()
			



			function reCount() {
				const nums = document.querySelectorAll('.block_card_front');
				
				nums.forEach((n, i) => n.textContent = i + 1);
			}
			nums.forEach((n, i) => n.textContent = i + 1);


			function useRole() {
				role.sort(()=>Math.random()-0.5);
				console.log(role);
				document.querySelectorAll('.card:not(.hidden) .block_card_back')	
						.forEach((n, i) => n.textContent = role[i]);
				reCount()
			}
			function useNumPlayers() {
				numberPlayers.sort(()=>Math.random()-0.5);
				console.log(numberPlayers);
				document.querySelectorAll('.card:not(.hidden) .block_card_back')
						.forEach((n, i) => n.textContent = numberPlayers[i]);
				reCount()
			}
			useNumPlayers()



			function changeBtn() {

				btnOne.addEventListener('click', () => {
					if (btnOne.classList.contains("active")) {
					    btnOne.classList.remove("active");
					    btnTwo.classList.add("active");
					    document.querySelectorAll('.card.hidden')
							.forEach(el => {
								el.classList.remove('hidden');
								el.querySelector('.active').classList.remove('active');
							})
						useRole()
					}
				})
				btnTwo.addEventListener('click', () => {
					if (btnTwo.classList.contains("active")) {
					    btnTwo.classList.remove("active");
					    btnOne.classList.add("active");
					    document.querySelectorAll('.card.hidden')
							.forEach(el =>{
								el.classList.remove('hidden');
								el.querySelector('.active').classList.remove('active');
							})
						useNumPlayers()
					}
				})
			}
			changeBtn()






			const flipCard = e => {

				const target = e.target.parentElement;

				if(target.classList.contains('active')){
					target.parentNode.classList.add('hidden');
					numberCard = numberCard.slice(0, count);
					count = count - 1
					document.querySelectorAll('.card:not(.hidden) .block_card_front')
							.forEach((n, i) => n.textContent = i + 1);
				} else {
					target.classList.add('active')
				}

				
			};
		

			cards.forEach(card => {
				card.addEventListener('click', flipCard)
			})
		</script>
    </body>
</html>